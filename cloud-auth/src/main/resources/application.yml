# Spring Application Configuration
spring:
  application:
    name: cloud-auth # 应用名称，用于Consul注册
  profiles:
    active: dev # 激活的配置文件，可以根据环境修改
  security:
    oauth2:
      authorizationserver:
        issuer: http://localhost:9000 # 授权服务器的Issuer URI，与AuthorizationServerConfig中配置的保持一致

  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    url: jdbc:postgresql://postgres:5432/${POSTGRES_DB}/auth
    username: ${POSTGRES_USER}
    password: ${POSTGRES_PASSWORD}
    driver-class-name: org.postgresql.Driver
    druid:
      initial-size: 5
      min-idle: 5
      max-active: 20
      max-wait: 60000
      time-between-eviction-runs-millis: 60000
      min-evictable-idle-time-millis: 300000
      validation-query: SELECT 1
      test-while-idle: true
      test-on-borrow: false
      test-on-return: false
      pool-prepared-statements: true
      max-pool-prepared-statement-per-connection-size: 20
      filters: stat,wall,log4j
      use-global-data-source-stat: true
      connection-properties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000

# Server Configuration
server:
  port: 9000 # 服务端口

# Consul Configuration
  cloud:
    consul:
      host: localhost # Consul服务地址
      port: 8500 # Consul端口
      discovery:
        service-name: ${spring.application.name} # 注册到Consul的服务名称
        prefer-ip-address: true # 优先使用IP地址注册
        health-check-path: /actuator/health # 健康检查路径
        health-check-interval: 10s # 健康检查间隔
      config:
        enabled: true # 启用Consul配置中心

# Logging Configuration (Log4j2 will pick up log4j2-spring.xml from common-core)
logging:
  level:
    root: INFO
    org.springframework.security: DEBUG # 方便调试Spring Security
    org.springframework.security.oauth2: DEBUG # 方便调试OAuth2流程